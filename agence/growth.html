<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO & Indexation -->
  <title>StratAds Growth | Acquisition Digitale & Croissance Structurée</title>
  <meta name="description" content="Propulsez votre activité avec StratAds Growth. Une solution d'acquisition standardisée et performante pour entrepreneurs, indépendants et TPE." />
  <meta name="robots" content="index, follow" />

  <!-- FAVICON -->
  <link rel="icon" type="image/png" href="/favicon.png" />
  <link rel="icon" type="image/png" href="favicon.png" />
  <link rel="apple-touch-icon" href="/favicon.png" />
  <link rel="apple-touch-icon" href="favicon.png" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet" />

  <!-- =========================================================
       ✅ DATA LAYER (AVANT TOUT) + CONSENT MODE DEFAULT DENIED
       - On démarre "denied" par défaut (RGPD-friendly)
       - On pousse page_type tout de suite
     ========================================================= -->
  <script>
    window.dataLayer = window.dataLayer || [];

    // page_type distinct (utile GA4/GTM/Netlify)
    window.dataLayer.push({ page_type: "growth" });

    // Consent default (avant tout tracking)
    window.dataLayer.push({
      event: "default_consent",
      consent: "denied"
    });
  </script>

  <style>
    :root{
      --brand-blue:#0089d0;
      --brand-blue-deep:#005f91;
      --brand-dark:#111827;
      --text-main:#374151;
      --text-muted:#6b7280;
      --bg-light:#f9fafb;
      --white:#ffffff;
      --border:#e5e7eb;

      --radius-lg:24px;
      --radius-md:12px;
      --shadow: 0 25px 50px -12px rgba(0,0,0,.10);
      --transition: all .25s cubic-bezier(.4,0,.2,1);

      --header-h: 80px;
    }

    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{
      font-family:'Inter',-apple-system,system-ui,Segoe UI,Roboto,sans-serif;
      color:var(--text-main);
      line-height:1.6;
      background:var(--white);
      -webkit-font-smoothing:antialiased;
      overflow-x:hidden;
    }

    .container{max-width:1200px;margin:0 auto;padding:0 24px}
    a{color:inherit}

    /* --- NAVIGATION --- */
    header{
      position:fixed;top:0;left:0;right:0;
      height:var(--header-h);
      background:rgba(255,255,255,.92);
      backdrop-filter: blur(14px);
      z-index:1000;
      border-bottom:1px solid var(--border);
      display:flex;align-items:center;
    }
    .nav-content{
      width:100%;
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:16px;
    }
    .brand{
      display:flex;align-items:center;gap:12px;
      text-decoration:none;
      min-width: 220px;
    }
    .logo-img{
      height:42px;
      width:42px;
      border-radius: 12px;
      display:block;
      box-shadow: 0 12px 24px rgba(0,0,0,.12);
      background: #fff;
      object-fit: cover;
    }
    .brand-name{
      font-weight:900;
      letter-spacing:-.03em;
      color:var(--brand-dark);
      line-height:1;
      font-size:1.05rem;
      white-space:nowrap;
    }
    .brand-name span{color:var(--brand-blue)}
    nav{display:flex;align-items:center;gap:14px;}

    .nav-links{display:flex;align-items:center;gap:10px;flex-wrap:wrap;}
    .chip{
      display:inline-flex;align-items:center;justify-content:center;
      padding:10px 14px;border-radius:999px;border:1px solid var(--border);
      text-decoration:none;font-weight:900;font-size:.9rem;
      color:var(--brand-dark);
      transition:var(--transition);
      background:rgba(255,255,255,.75);
    }
    .chip:hover{transform:translateY(-1px);border-color:rgba(0,137,208,.45)}
    .chip.active{
      border-color: rgba(0,137,208,.55);
      background: rgba(0,137,208,.12);
      color: var(--brand-blue-deep);
    }

    /* --- HERO --- */
    .hero{
      position:relative;
      min-height:100svh;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
      background:#eaf6ff;
      text-align:center;
      padding: calc(var(--header-h) + 40px) 0 72px;
      isolation:isolate;
    }
    #growth-canvas{
      position:absolute;inset:0;width:100%;height:100%;
      z-index:0;
      background:linear-gradient(135deg,#ffffff 0%,#d6f0ff 100%);
      filter: saturate(1.2) contrast(1.05);
    }
    .hero::after{
      content:"";position:absolute;inset:0;z-index:1;
      background:
        radial-gradient(1200px 700px at 50% 18%, rgba(0,137,208,.22), rgba(0,0,0,0) 60%),
        linear-gradient(to bottom, rgba(255,255,255,.15), rgba(255,255,255,.55));
      pointer-events:none;
    }
    .hero-content{position:relative;z-index:2;width:100%}
    .hero h1{
      font-size: clamp(2.6rem, 10vw, 6.4rem);
      font-weight: 900;
      line-height: .9;
      letter-spacing: -0.055em;
      text-transform: uppercase;
      margin-bottom: 18px;
      color: var(--brand-dark);
    }
    .hero h1 span{
      color:var(--brand-blue);
      text-shadow: 0 10px 30px rgba(0,137,208,.22);
    }
    .hero p{
      font-size: clamp(1.05rem, 2.8vw, 1.35rem);
      color: var(--text-main);
      margin: 0 auto 28px;
      max-width: 820px;
      font-weight: 700;
      background: rgba(255,255,255,.70);
      backdrop-filter: blur(6px);
      padding: 12px 14px;
      border-radius: 14px;
      border: 1px solid rgba(229,231,235,.75);
    }
    .hero-actions{display:flex;gap:14px;justify-content:center;flex-wrap:wrap;}

    /* --- BOUTONS --- */
    .btn{
      display:inline-flex;align-items:center;justify-content:center;
      padding: 16px 28px;
      border-radius: var(--radius-md);
      font-weight: 900;
      text-decoration:none;
      transition: var(--transition);
      border:none;
      cursor:pointer;
      font-size:1.05rem;
      letter-spacing:-.01em;
      white-space:nowrap;
    }
    .btn-primary{background:var(--brand-blue);color:var(--white)}
    .btn-primary:hover{
      background:var(--brand-dark);
      transform: translateY(-2px);
      box-shadow: 0 18px 40px rgba(0,137,208,.26);
    }
    .btn-outline{
      border:2px solid rgba(0,137,208,.65);
      color:var(--brand-blue-deep);
      background:rgba(255,255,255,.65);
    }
    .btn-outline:hover{background:rgba(0,137,208,.14);transform: translateY(-2px);}

    /* --- SECTIONS --- */
    section{padding: 96px 0; position:relative; z-index:2; background: #fff}
    .bg-light{background:var(--bg-light)}
    h2{
      font-size: clamp(2rem, 5vw, 3rem);
      color: var(--brand-dark);
      text-align:center;
      margin-bottom: 56px;
      font-weight: 900;
      letter-spacing: -0.04em;
    }
    .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:22px}
    .card{
      background:var(--white);
      padding: 40px;
      border-radius: var(--radius-lg);
      border:1px solid var(--border);
      transition:var(--transition);
      box-shadow: 0 0 0 rgba(0,0,0,0);
    }
    .card:hover{border-color:rgba(0,137,208,.40);transform:translateY(-6px);box-shadow: var(--shadow)}
    .card h3{font-size:1.45rem;margin-bottom:10px;font-weight:900;color:var(--brand-dark)}
    .card p{color:var(--text-main);font-weight:600}

    /* --- COMPARATIF --- */
    .comparison{background:var(--bg-light)}
    .comp-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:22px}
    .comp-card{
      background:var(--white);
      padding: 44px;
      border-radius: var(--radius-lg);
      border:1px solid var(--border);
      position:relative;
      transition: var(--transition);
    }
    .comp-card:hover{transform:translateY(-4px);box-shadow: var(--shadow)}
    .comp-card.growth{border: 2px solid rgba(0,137,208,.55)}
    .comp-badge{
      position:absolute;top:-14px;left:26px;
      background:var(--brand-blue);
      color:#fff;
      padding:6px 14px;
      border-radius:999px;
      font-size:.85rem;
      font-weight: 900;
      box-shadow: 0 12px 24px rgba(0,137,208,.22);
    }
    .comp-card h4{font-size: 1.4rem;color: var(--brand-dark);font-weight: 900;margin-bottom: 10px;}
    .comp-card p{color:var(--text-main);font-weight:600}
    .comp-list{list-style:none;margin-top:22px}
    .comp-list li{
      padding: 12px 0;
      border-bottom: 1px solid #f3f4f6;
      display:flex;align-items:flex-start;
      font-weight:700;
      gap:10px;
    }
    .comp-list li::before{
      content:"✓";
      color:var(--brand-blue);
      font-weight:900;
      margin-top:1px;
    }

    /* --- CONTACT --- */
    .contact-section{background: var(--brand-dark); color: var(--white)}
    .contact-section h2{color:var(--white)}
    .contact-form{
      max-width: 720px;
      margin: 0 auto;
      background: var(--white);
      padding: 44px;
      border-radius: var(--radius-lg);
      color: var(--brand-dark);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 40px 80px rgba(0,0,0,.22);
    }
    .form-grid{display:grid;grid-template-columns: 1fr 1fr;gap: 18px;}
    .form-group{margin-bottom: 14px}
    label{
      display:block;margin-bottom: 8px;font-weight: 900;font-size: .85rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: .06em;
    }
    input, select, textarea{
      width:100%;
      padding: 14px 14px;
      border-radius: 12px;
      border: 1.5px solid var(--border);
      font-family: inherit;
      font-size: 1rem;
      transition: var(--transition);
      background: #fff;
    }
    textarea{min-height:120px;resize:vertical}
    input:focus, select:focus, textarea:focus{
      outline: none;
      border-color: rgba(0,137,208,.55);
      box-shadow: 0 0 0 4px rgba(0,137,208,.12);
    }
    .form-actions{margin-top: 10px}
    .small-note{
      margin-top: 12px;
      font-size: .95rem;
      color: #6b7280;
      font-weight: 700;
      text-align:center;
    }

    /* Sticky Mobile CTA */
    .sticky-cta{
      position:fixed;bottom:0;left:0;right:0;
      background: rgba(255,255,255,.96);
      padding: 12px 16px;
      border-top: 1px solid var(--border);
      display:none;
      z-index:1000;
      box-shadow: 0 -10px 30px rgba(0,0,0,.12);
      backdrop-filter: blur(10px);
    }

    /* FOOTER */
    footer{padding: 76px 0;text-align:center;border-top: 1px solid var(--border);background:#fff;}
    .footer-logo{
      height: 42px;width: 42px;border-radius: 12px;margin-bottom: 18px;opacity: .95;
      box-shadow: 0 10px 20px rgba(0,0,0,.10);
    }

    /* ✅ Cookie banner CSS (IMPORTANT) */
    .cookie-banner{
      position:fixed;
      left:16px; right:16px; bottom:16px;
      z-index:2000;
      display:none;
      gap:14px;
      align-items:center;
      justify-content:space-between;
      padding:14px 16px;
      border-radius:14px;
      background:#111;
      color:#fff;
      box-shadow:0 10px 30px rgba(0,0,0,.25);
      font-size:14px;
      line-height:1.35;
    }
    .cookie-svg{width:44px;height:44px;flex:0 0 auto;}
    .cookie-text{margin:0;flex:1 1 auto;opacity:.95;}
    .cookie-actions{display:flex;gap:10px;flex:0 0 auto;}
    .cookie-btn{
      border:none;cursor:pointer;
      padding:10px 14px;border-radius:12px;
      font-weight:900;font-size:14px;
      transition:transform .08s ease, opacity .2s ease;
    }
    .cookie-btn:active{transform:scale(.98)}
    .cookie-btn.accept{background:#00c389;color:#06110c;}
    .cookie-btn.refuse{
      background:#2b2b2b;color:#fff;
      border:1px solid rgba(255,255,255,.18);
    }

    @media (max-width: 900px){
      .contact-form{padding: 34px}
      .card{padding: 32px}
      .comp-card{padding: 36px}
    }
    @media (max-width: 768px){
      :root{--header-h: 72px;}
      .sticky-cta{display:block}
      header .btn{display:none}
      .container{padding: 0 16px}
      .brand{min-width:auto}
      .brand-name{display:none}
      .nav-links{display:flex;gap:8px;}
      .chip{padding: 9px 10px;font-size: .85rem;}
      section{padding: 80px 0}
      .hero{min-height: 88svh;padding: calc(var(--header-h) + 40px) 0 64px}
      .hero-actions{gap:12px}
      .btn{width: 100%; max-width: 360px}
      .form-grid{grid-template-columns: 1fr}
      .cookie-banner{flex-direction:column;align-items:flex-start;}
      .cookie-actions{width:100%}
      .cookie-btn{width:100%}
    }
    @media (prefers-reduced-motion: reduce){ *{scroll-behavior:auto} }
  </style>
</head>

<body>
  <!-- =========================================================
       ✅ GTM NOSCRIPT (OK)
       NOTE: GTM SCRIPT sera injecté via JS uniquement si "accept"
     ========================================================= -->
  <noscript>
    <iframe src="https://www.googletagmanager.com/ns.html?id=GTM-NCZT7PQ"
      height="0" width="0" style="display:none;visibility:hidden"></iframe>
  </noscript>

  <!-- STICKY MOBILE -->
  <div class="sticky-cta">
    <a href="#contact" class="btn btn-primary" style="width:100%;" data-track="cta_sticky">Diagnostic Gratuit</a>
  </div>

  <!-- HEADER -->
  <header>
    <div class="container nav-content">
      <a class="brand" href="https://stratads.fr/" aria-label="Aller sur StratAds Premium" data-track="nav_to_premium">
        <img src="/favicon.png" alt="Logo StratAds" class="logo-img" onerror="this.onerror=null; this.src='favicon.png';" />
        <div class="brand-name">STRATADS <span>GROWTH</span></div>
      </a>

      <nav>
        <div class="nav-links" aria-label="Navigation">
          <a class="chip" href="https://stratads.fr/" data-track="switch_premium">StratAds Premium</a>
          <a class="chip active" href="croissance.html" data-track="switch_growth" aria-current="page">StratAds Growth</a>
        </div>
        <a href="#contact" class="btn btn-primary" data-track="cta_header">Diagnostic Gratuit</a>
      </nav>
    </div>
  </header>

  <!-- HERO -->
  <section class="hero">
    <canvas id="growth-canvas" aria-hidden="true"></canvas>
    <div class="hero-content">
      <div class="container">
        <h1>STRATADS <span>GROWTH</span></h1>
        <p>Structurez votre acquisition et accélérez vos résultats. La méthode StratAds en version accessible et standardisée pour entrepreneurs ambitieux et TPE.</p>
        <div class="hero-actions">
          <a href="#contact" class="btn btn-primary" data-track="cta_hero_main">Obtenir mon diagnostic</a>
          <a href="#comparatif" class="btn btn-outline" data-track="cta_hero_sec">Découvrir l'offre</a>
        </div>
      </div>
    </div>
  </section>

  <!-- POUR QUI -->
  <section>
    <div class="container">
      <h2>L'acquisition pensée pour vous</h2>
      <div class="grid">
        <article class="card">
          <h3>Entrepreneurs</h3>
          <p>Focalisez-vous sur votre cœur de métier pendant que nous structurons un système simple pour générer des prospects.</p>
        </article>
        <article class="card">
          <h3>Indépendants</h3>
          <p>Stabilisez votre activité avec un flux régulier de demandes, sans complexifier votre quotidien.</p>
        </article>
        <article class="card">
          <h3>TPE / PME</h3>
          <p>Passez un cap avec une structure de campagnes claire, suivie et optimisée avec méthode.</p>
        </article>
      </div>
    </div>
  </section>

  <!-- COMPARATIF -->
  <section class="comparison" id="comparatif">
    <div class="container">
      <h2>Growth ou Premium ?</h2>
      <div class="comp-grid">
        <div class="comp-card growth">
          <span class="comp-badge">OFFRE GROWTH</span>
          <h4>StratAds Growth</h4>
          <p>Une solution structurée pour lancer et stabiliser votre acquisition digitale.</p>
          <ul class="comp-list">
            <li>Setup publicitaire expert (Meta ou Google)</li>
            <li>Structure de campagne standardisée</li>
            <li>Reporting mensuel de performance</li>
            <li>Accompagnement réactif par email</li>
            <li>Idéal budgets &lt; 2 500€ / mois</li>
          </ul>
        </div>

        <div class="comp-card">
          <h4>StratAds Premium</h4>
          <p>Un accompagnement avancé pour les entreprises qui veulent aller beaucoup plus loin.</p>
          <ul class="comp-list">
            <li>Stratégie omnicanale personnalisée</li>
            <li>Optimisation complète du tunnel de vente</li>
            <li>Scaling + tests A/B intensifs</li>
            <li>Appels stratégiques réguliers</li>
            <li>Tracking data & analytique avancée</li>
          </ul>
        </div>
      </div>

      <div style="text-align:center;margin-top:22px;">
        <a class="chip" href="https://stratads.fr/" data-track="cta_to_premium">Découvrir StratAds Premium</a>
      </div>
    </div>
  </section>

  <!-- CONTACT -->
  <section id="contact" class="contact-section">
    <div class="container">
      <h2>Prêt pour la croissance ?</h2>

      <div class="contact-form">
        <!-- ✅ FORMULAIRE NETLIFY (distinct) -->
        <form
          id="growth-form"
          name="stratads-growth"
          method="POST"
          netlify
          data-netlify="true"
          data-netlify-honeypot="bot-field"
          action="/merci"
        >
          <!-- ✅ Obligatoires Netlify -->
          <input type="hidden" name="form-name" value="stratads-growth" />
          <input type="hidden" name="subject" value="Nouveau lead – Growth" />
          <input type="hidden" name="page_type" value="growth" />

          <!-- ✅ Ajout utile : consent snapshot -->
          <input type="hidden" id="cookie_consent_snapshot" name="cookie_consent" value="" />

          <!-- Honeypot anti-spam -->
          <p style="display:none;">
            <label>Ne pas remplir :
              <input name="bot-field" autocomplete="off" />
            </label>
          </p>

          <div class="form-grid">
            <div class="form-group">
              <label for="name">Nom complet</label>
              <input type="text" id="name" name="name" placeholder="Votre nom" autocomplete="name" required />
            </div>

            <div class="form-group">
              <label for="email">Email professionnel</label>
              <input type="email" id="email" name="email" placeholder="contact@entreprise.com" autocomplete="email" required />
            </div>
          </div>

          <div class="form-grid">
            <div class="form-group">
              <label for="url">Site / page</label>
              <input type="url" id="url" name="url" placeholder="https://www.votre-site.com" inputmode="url" />
            </div>

            <div class="form-group">
              <label for="budget">Budget pub mensuel estimé</label>
              <select id="budget" name="budget" required>
                <option value="" disabled selected>Choisir…</option>
                <option value="500-1000">500€ - 1 000€</option>
                <option value="1000-3000">1 000€ - 3 000€</option>
                <option value="3000+">Plus de 3 000€</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="goal">Objectif principal</label>
            <select id="goal" name="goal" required>
              <option value="" disabled selected>Choisir…</option>
              <option value="leads">Obtenir plus de leads</option>
              <option value="sales">Augmenter les ventes</option>
              <option value="visibility">Gagner en visibilité</option>
              <option value="structure">Structurer mon acquisition</option>
            </select>
          </div>

          <div class="form-group">
            <label for="message">Message (optionnel)</label>
            <textarea id="message" name="message" placeholder="Contexte, offre, cible, zone géographique, etc."></textarea>
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary" style="width:100%;" data-track="form_submit">
              Recevoir mon diagnostic gratuit
            </button>
            <div class="small-note">Réponse sous 48h (jours ouvrés).</div>
          </div>
        </form>

        <div id="success" style="display:none;text-align:center;padding-top:12px;font-weight:900;color:var(--brand-blue);">
          Demande envoyée ! Nous revenons vers vous sous 48h.
        </div>

        <div id="error" style="display:none;text-align:center;padding-top:12px;font-weight:900;color:#ef4444;">
          Oups — envoi impossible. Réessaie ou contacte-nous via StratAds Premium.
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer>
    <div class="container">
      <img src="/favicon.png" alt="StratAds" class="footer-logo" onerror="this.onerror=null; this.src='favicon.png';" />
      <p style="color:var(--text-muted);font-size:.95rem;font-weight:800;">
        © 2024 StratAds Growth — performance accessible & structurée.
      </p>
      <p style="margin-top:10px;">
        <a class="chip" href="https://stratads.fr/" data-track="footer_to_premium">Aller sur StratAds Premium</a>
      </p>
    </div>
  </footer>

  <!-- =========================================================
       ✅ COOKIE BANNER (DOIT ÊTRE DANS <body>)
     ========================================================= -->
  <div id="cookie-banner" class="cookie-banner" role="dialog" aria-live="polite" aria-label="Cookies">
    <svg class="cookie-svg" viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
      <circle cx="256" cy="256" r="224" fill="#E6AA68"/>
      <path fill="#CCA05A" d="M256 32c-123.7 0-224 100.3-224 224s100.3 224 224 224 224-100.3 224-224S379.7 32 256 32z" opacity="0.3"/>
      <circle cx="180" cy="160" r="25" fill="#3E2723"/>
      <circle cx="340" cy="200" r="30" fill="#3E2723"/>
      <circle cx="260" cy="320" r="35" fill="#3E2723"/>
      <circle cx="140" cy="300" r="20" fill="#3E2723"/>
      <circle cx="380" cy="320" r="22" fill="#3E2723"/>
      <circle cx="280" cy="100" r="20" fill="#3E2723"/>
      <circle cx="100" cy="220" r="15" fill="#3E2723"/>
      <circle cx="400" cy="120" r="18" fill="#3E2723"/>
    </svg>

    <p class="cookie-text">
      Nous utilisons des cookies pour mesurer l’audience et améliorer votre expérience.
      Vous pouvez accepter ou refuser.
    </p>

    <div class="cookie-actions">
      <button id="accept-cookies" class="cookie-btn accept" type="button">Accepter</button>
      <button id="refuse-cookies" class="cookie-btn refuse" type="button">Refuser</button>
    </div>
  </div>

  <script>
    // =========================
    // Cookie helpers
    // =========================
    function setCookie(name, value, days) {
      const d = new Date();
      d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
      document.cookie = name + "=" + value + ";path=/;expires=" + d.toUTCString() + ";SameSite=Lax";
    }

    function getCookie(name) {
      const value = `; ${document.cookie}`;
      const parts = value.split(`; ${name}=`);
      if (parts.length === 2) return parts.pop().split(";").shift();
    }

    function showBanner() {
      const banner = document.getElementById("cookie-banner");
      if (banner) banner.style.display = "flex";
    }

    function hideBanner() {
      const banner = document.getElementById("cookie-banner");
      if (banner) banner.style.display = "none";
    }

    // =========================
    // ✅ Load GTM only on accept
    // =========================
    function loadGTM() {
      if (window.__gtm_loaded) return;
      window.__gtm_loaded = true;

      // inject gtm.js
      const s = document.createElement("script");
      s.async = true;
      s.src = "https://www.googletagmanager.com/gtm.js?id=GTM-NCZT7PQ";
      document.head.appendChild(s);

      // tell dataLayer
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({ event: "gtm_loaded_via_consent" });
    }

    function pushConsent(consent) {
      window.dataLayer = window.dataLayer || [];
      window.dataLayer.push({
        event: "cookie_consent",
        consent: consent // "granted" | "denied"
      });
    }

    function applyConsent(choice) {
      // update hidden field for Netlify
      const snap = document.getElementById("cookie_consent_snapshot");
      if (snap) snap.value = choice;

      if (choice === "accepted") {
        pushConsent("granted");
        loadGTM();
      } else {
        pushConsent("denied");
      }
    }

    // Init banner
    (function initCookieBanner() {
      const consent = getCookie("cookie_consent");
      if (!consent) {
        showBanner();
        applyConsent("refused"); // default denied tant que pas de choix
        return;
      }
      hideBanner();
      applyConsent(consent);
    })();

    // Buttons
    document.getElementById("accept-cookies").addEventListener("click", function () {
      setCookie("cookie_consent", "accepted", 365);
      applyConsent("accepted");
      hideBanner();
    });

    document.getElementById("refuse-cookies").addEventListener("click", function () {
      setCookie("cookie_consent", "refused", 365);
      applyConsent("refused");
      hideBanner();
    });
  </script>

  <script>
    /**
     * FOND DYNAMIQUE
     */
    const canvas = document.getElementById('growth-canvas');
    const ctx = canvas.getContext('2d', { alpha: true });

    let W = 0, H = 0, DPR = 1;
    let particles = [];
    let bars = [];
    let rafId = null;

    function isMobile() {
      return window.matchMedia('(max-width: 768px)').matches;
    }

    function setupCanvasSize() {
      DPR = Math.min(window.devicePixelRatio || 1, 2);
      W = Math.floor(window.innerWidth);
      H = Math.floor(window.innerHeight);

      canvas.width = Math.floor(W * DPR);
      canvas.height = Math.floor(H * DPR);
      canvas.style.width = W + 'px';
      canvas.style.height = H + 'px';
      ctx.setTransform(DPR, 0, 0, DPR, 0, 0);
    }

    function initAnimation() {
      setupCanvasSize();

      const particleCount = isMobile() ? 42 : 78;
      const barCount = isMobile() ? 10 : 16;

      particles = [];
      for (let i = 0; i < particleCount; i++) {
        particles.push({
          x: Math.random() * W,
          y: Math.random() * H,
          vx: (Math.random() - 0.5) * (isMobile() ? 0.55 : 0.85),
          vy: (Math.random() - 0.5) * (isMobile() ? 0.55 : 0.85),
          size: Math.random() * 2.2 + (isMobile() ? 1.3 : 1.6),
        });
      }

      bars = [];
      for (let i = 0; i < barCount; i++) {
        bars.push({
          x: (W / barCount) * i + Math.random() * 50,
          w: isMobile() ? 30 : 46,
          h: 0,
          targetH: Math.random() * (H * 0.48) + 90,
          speed: Math.random() * 0.025 + 0.007,
        });
      }
    }

    function draw() {
      ctx.clearRect(0, 0, W, H);

      ctx.shadowBlur = 18;
      ctx.shadowColor = "rgba(0,137,208,0.25)";

      for (const bar of bars) {
        bar.h += (bar.targetH - bar.h) * bar.speed;
        if (Math.abs(bar.h - bar.targetH) < 1) {
          bar.targetH = Math.random() * (H * 0.48) + 70;
        }
        const grad = ctx.createLinearGradient(0, H, 0, H - bar.h);
        grad.addColorStop(0, 'rgba(0, 137, 208, 0.10)');
        grad.addColorStop(1, 'rgba(0, 137, 208, 0.40)');
        ctx.fillStyle = grad;
        ctx.fillRect(bar.x, H - bar.h, bar.w, bar.h);
      }

      ctx.shadowBlur = 10;
      for (const p of particles) {
        p.x += p.vx;
        p.y += p.vy;
        if (p.x < 0 || p.x > W) p.vx *= -1;
        if (p.y < 0 || p.y > H) p.vy *= -1;

        ctx.fillStyle = 'rgba(0, 137, 208, 0.70)';
        ctx.beginPath();
        ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
        ctx.fill();
      }

      const connectionDist = isMobile() ? 150 : 190;
      ctx.shadowBlur = 0;

      for (let i = 0; i < particles.length; i++) {
        for (let j = i + 1; j < particles.length; j++) {
          const dx = particles[i].x - particles[j].x;
          const dy = particles[i].y - particles[j].y;
          const dist = Math.sqrt(dx * dx + dy * dy);
          if (dist < connectionDist) {
            ctx.strokeStyle = `rgba(0, 137, 208, ${0.55 * (1 - dist / connectionDist)})`;
            ctx.lineWidth = 1.6;
            ctx.beginPath();
            ctx.moveTo(particles[i].x, particles[i].y);
            ctx.lineTo(particles[j].x, particles[j].y);
            ctx.stroke();
          }
        }
      }

      rafId = requestAnimationFrame(draw);
    }

    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        if (rafId) cancelAnimationFrame(rafId);
        rafId = null;
      } else {
        if (!rafId) draw();
      }
    });

    window.addEventListener('resize', () => {
      initAnimation();
    });

    initAnimation();
    draw();

    /**
     * NETLIFY FORM (AJAX submit + message success)
     */
    const form = document.getElementById('growth-form');
    const success = document.getElementById('success');
    const errorBox = document.getElementById('error');

    function encodeFormData(formEl) {
      const data = new FormData(formEl);
      return new URLSearchParams(data).toString();
    }

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      success.style.display = 'none';
      errorBox.style.display = 'none';

      // snapshot consent at submit time
      const snap = document.getElementById("cookie_consent_snapshot");
      if (snap && !snap.value) {
        // if user never chose, treat as refused
        snap.value = (getCookie("cookie_consent") || "refused");
      }

      const submitBtn = form.querySelector('button[type="submit"]');
      submitBtn.disabled = true;
      submitBtn.style.opacity = '0.85';

      try {
        const body = encodeFormData(form);
        const res = await fetch('/', {
          method: 'POST',
          headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
          body
        });
        if (!res.ok) throw new Error('Network');

        form.style.display = 'none';
        success.style.display = 'block';

        // optional: push event (only meaningful if GTM loaded)
        window.dataLayer = window.dataLayer || [];
        window.dataLayer.push({ event: "growth_form_success" });

      } catch (err) {
        errorBox.style.display = 'block';
      } finally {
        submitBtn.disabled = false;
        submitBtn.style.opacity = '1';
      }
    });
  </script>
</body>
</html>
